!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=52)}({0:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var i=s.apply(null,r);i&&e.push(i)}else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}void 0!==e&&e.exports?(s.default=s,e.exports=s):void 0===(r=function(){return s}.apply(t,[]))||(e.exports=r)}()},3:function(e,t,n){"use strict";function r(){return genesis_page_builder_globals.blockSettingsPermissions}function s(){var e=[];return wp.blocks.getBlockTypes().map(function(t){(t.name.startsWith("genesis-blocks")||t.name.startsWith("genesis-page-builder"))&&e.push(t)}),e=e.filter(function(e){return e.hasOwnProperty("gb_settings_data")||e.hasOwnProperty("gpb_settings_data")})}function o(){return genesis_page_builder_globals.allRoles}n.r(t),n.d(t,"getBlockSettingsPermissions",function(){return r}),n.d(t,"get_registered_gpb_blocks",function(){return s}),n.d(t,"getAllRoles",function(){return o}),wp.hooks.addFilter("gb_should_render_block_setting","gpb",function(e,t,n,s){var o=r();return void 0===o[t]||void 0===o[t][n]?e:s.roles.some(function(e){return!0===o[t][n][e]})})},52:function(e,t,n){"use strict";n.r(t),n.d(t,"App",function(){return B});var r=n(3),s=n(0),o=n.n(s);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(n,!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,s=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){s=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(s)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var m=window.React,f=m.Component,k=m.useState,y=m.useEffect,v=wp.i18n.__,h=wp.components.Fill,E=wp.plugins.registerPlugin,_=wp.hooks.addAction,O=wp.data.dispatch,j=wp.apiFetch,w="block_settings_permissions",x=function(e){return m.createElement(m.Fragment,null,m.createElement("label",{className:"gb-checkbox-label"},m.createElement("input",{type:"checkbox",name:e.checkboxName,value:e.role.toLowerCase(),checked:e.checked,onChange:function(t){return e.onClick(t)},"data-setting":e.setting,"data-block":e.block}),e.role))},P=function(e){return m.createElement("fieldset",null,m.createElement("legend",{className:"screen-reader-text"},m.createElement("span",null,v("Roles","genesis-page-builder"))),Object.values(e.roles).map(function(t){var n=!0;if(void 0!==e.permissions[e.block]&&void 0!==e.permissions[e.block][e.setting.name]){var r=t.name.toLowerCase();n=e.permissions[e.block][e.setting.name][r]}return m.createElement(x,{key:"key_"+e.block+"_"+e.setting.name+"_"+t.name.toLowerCase(),block:e.block,role:t.name,setting:e.setting.name,checkboxName:"genesis-page-builder-settings[block_settings_permissions][".concat(e.block,"][").concat(e.setting.name,"][]"),checked:n,onClick:e.onClick})}))},S=function(e){var t=d(k(e.allExpanded||e.isOpen),2),n=t[0],r=t[1];return y(function(){var t=e.allExpanded||e.isOpen;r(t)},[e.isOpen]),m.createElement("details",{key:"key_"+e.setting,className:o()("gpb-control-settings-control-settings-entry gb-admin-accordion-panel",n?"gpb-control-settings-entry-open":null),open:n},m.createElement("summary",{className:"gpb-control-settings-block-setting-summary"},m.createElement("h4",null,e.setting.title)),m.createElement("div",{className:"gpb-control-settings-block-permission gb-details-content"},m.createElement(P,{roles:e.roles,permissions:e.permissions,setting:e.setting,block:e.block.name,onClick:e.onClick})))},C=function(e){var t=d(k(e.isOpen),2),n=t[0],r=t[1];return y(function(){r(e.isOpen)},[e.isOpen]),m.createElement(m.Fragment,null,m.createElement("details",{className:"gpb-control-settings-block gb-admin-accordion-panel",open:n},m.createElement("summary",{className:"gpb-control-settings-block-summary"},m.createElement("h3",null,e.block.title),m.createElement("div",{className:"gpb-control-settings-entry-header"},m.createElement("span",{class:"screen-reader-text"}," ",v("Block Settings Permissions","genesis-page-builder")))),m.createElement("div",{className:o()("gpb-control-settings-control-settings gb-details-content",n?"gpb-control-settings-control-settings-open":null)},void 0!==e.settings&&Object.keys(e.settings).map(function(t){return m.createElement(S,{key:"key_"+e.block.name+"_"+t,roles:e.roles,permissions:e.permissions,setting:{name:t,title:e.settings[t].title},block:e.block,onClick:e.onClick,isOpen:e.allExpanded,allExpanded:e.allExpanded})}))))},N=function(e){return m.createElement("div",{className:"gpb-control-settings-entry"},m.createElement(C,{roles:e.roles,settings:e.settings[e.block.name],permissions:e.permissions,block:e.block,onClick:e.onClick,isOpen:e.isOpen,allExpanded:e.allExpanded}))},A=function(e){return m.createElement("div",{className:"gpb-control-settings-entries"},e.blocks.map(function(t){return m.createElement(N,{key:"key_"+t.name,settings:e.settings,roles:e.roles,block:t,onClick:e.onClick,permissions:e.permissions,isOpen:e.allExpanded,allExpanded:e.allExpanded})}))},B=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?g(e):t}(this,p(t).call(this,e))).state={permissions:e.permissions||{},allExpanded:!1},n.updatePermissionsState=n.updatePermissionsState.bind(g(n)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,f),function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(t,[{key:"updatePermissionsState",value:function(e){var t=O("genesis-blocks/global-settings").updateCustom,n=this.state.permissions;void 0===n[e.target.dataset.block]&&(n[e.target.dataset.block]={}),void 0===n[e.target.dataset.block][e.target.dataset.setting]&&(n[e.target.dataset.block][e.target.dataset.setting]={}),void 0===n[e.target.dataset.block][e.target.dataset.setting][e.target.value]&&(n[e.target.dataset.block][e.target.dataset.setting][e.target.value]={}),n[e.target.dataset.block][e.target.dataset.setting][e.target.value]=e.target.checked,this.setState({permissions:n}),t({key:w,value:n})}},{key:"render",value:function(){var e=this;return m.createElement("div",{className:"gpb-control-settings"},m.createElement("div",{className:"gpb-control-settings-head"},m.createElement("div",null,m.createElement("h2",null,v("Block Name","genesis-page-builder"))),m.createElement("div",null,m.createElement("button",{onClick:function(){e.setState({allExpanded:!0})},className:o()("gpb-control-settings-expand-all gb-admin-button-link aligned",this.state.allExpanded?"gpb-hidden":null)},v("Expand All","genesis-page-builder")),m.createElement("button",{onClick:function(){e.setState({allExpanded:!1})},className:o()("gpb-control-settings-collapse-all gb-admin-button-link aligned",this.state.allExpanded?"gpb-visible":null)},v("Collapse All","genesis-page-builder")))),m.createElement(A,{settings:this.props.settings,roles:this.props.roles,blocks:this.props.blocks,onClick:function(t){e.updatePermissionsState(t)},permissions:this.state.permissions,allExpanded:this.state.allExpanded}))}}]),t}(),R=function(e){var t={};return Object.values(e).map(function(e){void 0!==e.gb_settings_data&&(t[e.name]=e.gb_settings_data),void 0!==e.gpb_settings_data&&(t[e.name]=e.gpb_settings_data)}),t};E("genesis-pro-permission-settings",{render:function(){var e=Object(r.get_registered_gpb_blocks)(),t=Object(r.getBlockSettingsPermissions)();return m.createElement(h,{name:"GenesisBlocksSettings_block_permissions_section"},m.createElement(B,{blocks:e,settings:R(e),roles:Object(r.getAllRoles)(),permissions:function(e){if(Object.keys(e).length>0)return e;for(var t=Object.keys(Object(r.getAllRoles)()).reduce(function(e,t){return e[t]=!0,e},{}),n=R(Object(r.get_registered_gpb_blocks)()),s=0,o=Object.entries(n);s<o.length;s++){var i=d(o[s],2),a=i[0],c=i[1];for(var u in c)n[a][u]=l({title:n[a][u].title},t)}return n}(t)}))}});_("genesisBlocks.savingSettings","genesisBlocks",function(e,t){if(t.hasOwnProperty(w)){for(var n=0,r=Object.entries(t[w]);n<r.length;n++){var s=d(r[n],2),o=s[0],i=s[1];for(var a in i)delete t[w][o][a].title}j({path:"/genesis-page-builder/v1/block-permissions",method:"PUT",data:t[w]})}})}});